<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Abastecimentos</title>
  <style>
    :root{
      --bg:#e8fffb;--brand-dark:#0b4c59;--brand-mid:#3db7ac;--white:#fff;--text:#0b1f1e;
      --radius-lg:16px;--radius-md:12px;--radius-sm:8px;--shadow:0 8px 24px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;color:var(--text);background:var(--bg);-webkit-text-size-adjust:100%}
    .app{max-width:680px;margin:16px auto;padding:16px}
    .card-header{background:var(--brand-dark);color:var(--white);padding:20px 16px;border-radius:var(--radius-lg);box-shadow:var(--shadow);text-align:center}
    .title{margin:0 0 4px;font-size:clamp(22px,5vw,36px);letter-spacing:.5px}
    .subtitle{margin:0;opacity:.9;font-weight:600;font-size:clamp(14px,3.4vw,18px)}
    .section-title{margin:20px 0 8px;background:#3db7ac;color:#0b1f1e;font-weight:800;letter-spacing:.5px;padding:10px 14px;border-radius:var(--radius-md)}
    .card{background:var(--white);border-radius:var(--radius-lg);box-shadow:var(--shadow);padding:16px}
    .field{margin-bottom:14px}.label{display:block;font-weight:700;margin-bottom:8px}
    .control,.control2{display:block;width:100%;min-height:44px;font-size:16px;padding:10px 12px;border:1px solid #cfd8dc;border-radius:var(--radius-sm);background:#f9fafa;outline:none}
    .control2{padding:40px 12px}
    .control:focus,.control2:focus{border-color:var(--brand-mid);box-shadow:0 0 0 3px rgba(61,183,172,.25);background:#fff}
    input[type="datetime-local"].control{-webkit-appearance:none;appearance:none;max-width:100%;margin:0;padding-right:12px}
    .actions{margin-top:8px}
    .btn{width:100%;border:0;border-radius:12px;padding:28px 16px;font-weight:800;font-size:24px;color:#fff;background:var(--brand-dark);box-shadow:0 6px 14px rgba(1,61,53,.2);cursor:pointer}
    .btn:hover{filter:brightness(1.06)} .btn:active{transform:translateY(1px)}
    @media (max-width:420px){.app{padding:12px}}
  </style>
</head>
<body>
  <main class="app">
    <header class="card-header">
      <h1 class="title">ABASTECIMENTOS</h1>
      <p class="subtitle">Registro de Abastecimento</p>
    </header>

    <section class="card" aria-label="Formulário de Abastecimentos">
      <form id="form-abast" action="#" method="post" novalidate>

        <!-- DATA -->
        <h2 class="section-title">DATA</h2>
        <div class="field">
          <label for="dt" class="label">Data/Hora</label>
          <input id="dt" class="control" type="datetime-local" required placeholder="dd/mm/aaaa --:--"/>
        </div>

        <!-- LOCAL -->
        <h2 class="section-title">LOCAL</h2>
        <div class="field">
          <label for="local" class="label">Local</label>
          <input id="local" name="local" class="control" list="lista-locais" required placeholder="Digite ou escolha" />
          <datalist id="lista-locais">
            <option value="FÁBRICA LINHA 2 - LPL">
            <option value="INTERMODAL - PDN">
          </datalist>
        </div>

        <!-- PLACA -->
        <h2 class="section-title">PLACA</h2>
        <div class="field">
          <label for="placa" class="label">Placa</label>
          <input id="placa" name="placa" class="control" list="lista-placas" required placeholder="Digite ou escolha" />
          <datalist id="lista-placas">
            <option value="EMP0007"><option value="EMP0008"><option value="EMP0009"><option value="EMP0011">
            <option value="EMP0012"><option value="EMP0016"><option value="EMP0039"><option value="EMP0046">
            <option value="EMP0053"><option value="EMP0078"><option value="EMP0090"><option value="EMP0091">
            <option value="EMP0093"><option value="EMP0095"><option value="EMP0096"><option value="EMP0098"><option value="EMP0099">
          </datalist>
        </div>

        <!-- HORÍMETRO -->
        <h2 class="section-title">HORÍMETRO</h2>
        <div class="field">
          <label for="horimetro" class="label">Horímetro</label>
          <input id="horimetro" type="number" class="control" placeholder="Inserir km/horímetro do equipamento" inputmode="numeric" required />
        </div>

        <!-- COMBUSTÍVEL -->
        <h2 class="section-title">COMBUSTÍVEL</h2>
        <div class="field">
          <label for="combustivel" class="label">Quantidade</label>
          <input id="combustivel" type="number" step="any" inputmode="decimal" class="control"
                 placeholder="Insira a quantidade de kg ou litros" required />
        </div>

        <div class="actions">
          <button class="btn" id="btnEnviar" type="submit">Registrar</button>
        </div>
      </form>
    </section>
  </main>

  <script>
    // ====== CONFIG ======
    const API_URL = "https://script.google.com/macros/s/AKfycbyxUVcvnGpmk3GxuqHkLYut8lb9BdnS_yS97oYqesNQ85z_FdonZRoOV2FtJClZWBywFg/exec"; // ajuste se necessário

    const form = document.getElementById('form-abast');
    const btn  = document.getElementById('btnEnviar');

    function limparCampos(){
      form.reset();
      document.getElementById('dt').value = '';
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const dados = {
        data: document.getElementById('dt').value,
        local: document.getElementById('local').value,
        placa: document.getElementById('placa').value,
        horimetro: document.getElementById('horimetro').value,
        combustivel_qtd: document.getElementById('combustivel').value
      };

      btn.disabled = true;
      btn.textContent = 'Enviando...';

      try{
        const body = 'dados=' + encodeURIComponent(JSON.stringify({
          action: 'salvarAbastecimento',   // <- certifique o mesmo nome no Apps Script
          dados
        }));

        const resp = await fetch(API_URL, {
          method: 'POST',
          headers: {'Content-Type':'application/x-www-form-urlencoded'},
          body
        });

        const json = await resp.json();
        if(json.sucesso){
          alert('✅ Abastecimento registrado com sucesso!');
          limparCampos();
        }else{
          alert('❌ Falha ao salvar: ' + (json.mensagem || 'erro desconhecido'));
        }
      }catch(err){
        console.error(err);
        alert('❌ Erro ao conectar ao servidor.');
      }finally{
        btn.disabled = false;
        btn.textContent = 'Registrar';
      }
    }); 
  </script>
</body>
</html>
